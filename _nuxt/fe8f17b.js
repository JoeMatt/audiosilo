(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{298:function(t,e,r){"use strict";var n=r(5),o=r(31),c=r(303),l=r(191),f=r(3),d=1..toFixed,v=Math.floor,h=function(t,e,r){return 0===e?r:e%2==1?h(t,e-1,r*t):h(t*t,e/2,r)},m=function(data,t,e){for(var r=-1,n=e;++r<6;)n+=t*data[r],data[r]=n%1e7,n=v(n/1e7)},x=function(data,t){for(var e=6,r=0;--e>=0;)r+=data[e],data[e]=v(r/t),r=r%t*1e7},w=function(data){for(var t=6,s="";--t>=0;)if(""!==s||0===t||0!==data[t]){var e=String(data[t]);s=""===s?e:s+l.call("0",7-e.length)+e}return s};n({target:"Number",proto:!0,forced:d&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!f((function(){d.call({})}))},{toFixed:function(t){var e,r,n,f,d=c(this),v=o(t),data=[0,0,0,0,0,0],_="",C="0";if(v<0||v>20)throw RangeError("Incorrect fraction digits");if(d!=d)return"NaN";if(d<=-1e21||d>=1e21)return String(d);if(d<0&&(_="-",d=-d),d>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(d*h(2,69,1))-69)<0?d*h(2,-e,1):d/h(2,e,1),r*=4503599627370496,(e=52-e)>0){for(m(data,0,r),n=v;n>=7;)m(data,1e7,0),n-=7;for(m(data,h(10,n,1),0),n=e-1;n>=23;)x(data,1<<23),n-=23;x(data,1<<n),m(data,1,1),x(data,2),C=w(data)}else m(data,0,r),m(data,1<<-e,0),C=w(data)+l.call("0",v);return C=v>0?_+((f=C.length)<=v?"0."+l.call("0",v-f)+C:C.slice(0,f-v)+"."+C.slice(f-v)):_+C}})},300:function(t,e,r){var content=r(307);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(79).default)("51cd7b17",content,!0,{sourceMap:!1})},303:function(t,e){var r=1..valueOf;t.exports=function(t){return r.call(t)}},306:function(t,e,r){"use strict";r(300)},307:function(t,e,r){var n=r(78)((function(i){return i[1]}));n.push([t.i,"/*purgecss start ignore*/\n.description-text p{\n  margin:15px 0\n}\n.readmore{\n  height:95px;\n  overflow:hidden\n}\n.readmore.active{\n  height:auto;\n  overflow:visible\n}\n\n/*purgecss end ignore*/",""]),n.locals={},t.exports=n},317:function(t,e,r){"use strict";r.r(e);var n=r(4),o=(r(44),r(22),r(30),r(34),r(298),r(12),r(23),r(17),r(53),r(137)),c={name:"BookDetails",props:["details","name","fake","server"],data:function(){return{readmore:!1,cached:!1,downloading:!1}},computed:{moretext:function(){return this.readmore?"Less..":"More.."},image:function(){return this.$store.state.app.book.cover},description:function(){return this.$store.state.app.book.description},transcode:function(){return this.$store.state.app.transcode},seek:function(){return this.$store.state.app.book.seek},hash:function(){return Object(o.sha256)(this.$route.fullPath)},totalTime:function(){var t=0;return this.details.files.forEach((function(e){t+=e.meta.duration})),t},remaining:function(){var t=this.totalTime-this.seek;return this.secondsToTime(t)+" remaining"},percent:function(){var t=(this.totalTime-this.seek)/this.totalTime*100;return 100-t.toFixed(0)}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.commit("app/rightbar",!0),e.next=3,caches.keys();case 3:r=e.sent,console.log("keys"),console.log(r),t.$store.dispatch("app/getBookDetails",Object(o.sha256)(t.$route.fullPath));case 7:case"end":return e.stop()}}),e)})))()},methods:{listen:function(){this.$store.commit("app/player",!0)},secondsToTime:function(t){var e=t%3600;return Math.floor(t/3600)+"h"+Math.floor(e/60)+"m"},download:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("download"),t.downloading=!0,e.next=4,navigator.storage.persist();case 4:return r=e.sent,console.log("Persisted storage granted: ".concat(r)),n="audioserv-".concat(t.hash),e.next=9,caches.delete(n);case 9:return e.next=11,caches.open(n);case 11:return o=e.sent,e.next=14,Promise.all(t.details.files.map((function(e){return o.add(t.server+"download/"+e.path)})));case 14:t.downloading=!1,t.cached=!0,console.log("files cached "+n);case 17:case"end":return e.stop()}}),e)})))()}}},l=(r(306),r(52)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex flex-col overflow-auto pb-8"},[r("div",{staticClass:"text p-8 pb-5 flex justify-center"},[r("img",{staticClass:"block shadow rounded-md",attrs:{src:t.image}})]),t._v(" "),r("div",{staticClass:"text-xl flex justify-center px-8 font-bold"},[t._v(t._s(t.name))]),t._v(" "),r("button",{staticClass:"text-white bg-purple-400 font-normal rounded-lg mx-8 my-4 p-3",on:{click:t.listen}},[r("i",{staticClass:"fa-light fa-circle-play"}),t._v(" Listen")]),t._v(" "),t.description?[r("div",{staticClass:"text px-8 description-text text-sm readmore",class:{active:t.readmore},domProps:{innerHTML:t._s(t.description)}}),t._v(" "),r("div",{staticClass:"px-8 text-purple-400 font-normal text-sm cursor-pointer",on:{click:function(e){t.readmore=!t.readmore}}},[t._v(t._s(t.moretext))])]:t._e(),t._v(" "),r("div",{staticClass:"px-8 mt-3 font-normal text-sm"},[t._v("Progress")]),t._v(" "),r("div",{staticClass:"flex px-8 pt-1 items-center"},[r("div",{staticClass:"relative flex-grow mr-2"},[r("div",{staticClass:"overflow-hidden h-1 text-xs flex rounded bg-purple-200"},[r("div",{staticClass:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-purple-400",style:{width:t.percent+"%"}})])]),t._v(" "),r("div",{staticClass:"text-sm"},[t._v(t._s(t.percent)+"%")])]),t._v(" "),r("div",{staticClass:"px-8 text-xs"},[t._v(t._s(t.remaining))]),t._v(" "),r("div",{staticClass:"px-8 pt-8"},[r("div",{staticClass:"cursor-pointer relative"},[r("span",{directives:[{name:"show",rawName:"v-show",value:!t.cached&&!t.downloading,expression:"!cached && !downloading"}],staticClass:"fa-layers fa-fw fa-2x",on:{click:t.download}},[r("i",{staticClass:"fa-solid fa-circle text-gray-600"}),t._v(" "),r("i",{staticClass:"fa-inverse fa-light fa-arrow-down-to-line",attrs:{"data-fa-transform":"shrink-8"}})]),t._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.downloading,expression:"downloading"}],staticClass:"fa-layers fa-fw fa-2x"},[r("i",{staticClass:"fa-solid fa-circle text-gray-600"}),t._v(" "),r("i",{staticClass:"fa-inverse fa-thin fa-down-to-line fa-beat",attrs:{"data-fa-transform":"shrink-8"}})]),t._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.cached,expression:"cached"}],staticClass:"fa-layers fa-fw fa-2x"},[r("i",{staticClass:"fa-solid fa-circle text-gray-600"}),t._v(" "),r("i",{staticClass:"fa-inverse fa-thin fa-trash-can",attrs:{"data-fa-transform":"shrink-8"}})]),t._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.downloading,expression:"downloading"}],staticClass:"fa-layers fa-fw fa-2x absolute inset-0 opacity-70"},[r("i",{staticClass:"fa-solid fa-circle text-gray-600"}),t._v(" "),r("i",{staticClass:"fa-inverse fa-light fa-spinner-third fa-spin",attrs:{"data-fa-transform":"shrink-2"}})])])])],2)}),[],!1,null,null,null);e.default=component.exports}}]);